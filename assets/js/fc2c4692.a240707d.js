"use strict";(self.webpackChunkrouter_docs=self.webpackChunkrouter_docs||[]).push([[1307],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=n.createContext({}),l=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(a),h=r,f=u["".concat(c,".").concat(h)]||u[h]||d[h]||o;return a?n.createElement(f,i(i({ref:t},p),{},{components:a})):n.createElement(f,i({ref:t},p))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=a[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},43443:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var n=a(87462),r=(a(67294),a(3905));const o={title:"Fee Management",sidebar_position:2,description:"Gas and fee payer considerations for CrossTalk"},i=void 0,s={unversionedId:"message-transfer-via-crosstalk/key-concepts/fee-management",id:"message-transfer-via-crosstalk/key-concepts/fee-management",title:"Fee Management",description:"Gas and fee payer considerations for CrossTalk",source:"@site/docs/develop/message-transfer-via-crosstalk/key-concepts/fee-management.md",sourceDirName:"message-transfer-via-crosstalk/key-concepts",slug:"/message-transfer-via-crosstalk/key-concepts/fee-management",permalink:"/develop/message-transfer-via-crosstalk/key-concepts/fee-management",draft:!1,editUrl:"https://github.com/router-protocol/docs/tree/main/docs/develop/message-transfer-via-crosstalk/key-concepts/fee-management.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Fee Management",sidebar_position:2,description:"Gas and fee payer considerations for CrossTalk"},sidebar:"tutorialSidebar",previous:{title:"High Level Architecture",permalink:"/develop/message-transfer-via-crosstalk/key-concepts/high-level-architecture"},next:{title:"Additional Security Modules (ASM)",permalink:"/develop/message-transfer-via-crosstalk/key-concepts/additional-security-modules"}},c={},l=[{value:"1. Fee Payer",id:"1-fee-payer",level:2},{value:"How to provide approval for the fee payer on the Router chain?",id:"how-to-provide-approval-for-the-fee-payer-on-the-router-chain",level:4},{value:"2. Gas Considerations",id:"2-gas-considerations",level:2},{value:"3. Deducting Fee",id:"3-deducting-fee",level:2},{value:"Important Notes",id:"important-notes",level:4},{value:"4. Handling Refunds",id:"4-handling-refunds",level:2}],p={toc:l};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"1-fee-payer"},"1. Fee Payer"),(0,r.kt)("p",null,"The fee associated with any cross-chain request initiated by a dApp is paid by the dApp's corresponding fee payer account on the Router chain. This fee payer account is set by the dApp for all the integrated chains and can be changed anytime. Any fee refunds are also credited to this account."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To designate the fee payer for any chain, the application must invoke the ",(0,r.kt)("inlineCode",{parentName:"li"},"setDappMetadata")," function on that chain's Gateway contract and provide a valid address on the Router chain."),(0,r.kt)("li",{parentName:"ul"},"To prevent unauthorized usage of someone else's address as the fee payer, the designated fee payer address must perform a fee payer approval transaction on the Router chain."),(0,r.kt)("li",{parentName:"ul"},"The fee payer address on the Gateway contract can be modified by the application at any time using the ",(0,r.kt)("inlineCode",{parentName:"li"},"setDappMetadata")," function.")),(0,r.kt)("h4",{id:"how-to-provide-approval-for-the-fee-payer-on-the-router-chain"},"How to provide approval for the fee payer on the Router chain?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The approval as a fee payer can be provided by accessing the ",(0,r.kt)("a",{parentName:"li",href:"https://explorer.testnet.routerchain.dev/feePayer"},"explorer"),"."),(0,r.kt)("li",{parentName:"ul"},"The user can search for the dApp address or the fee payer address on the explorer to view all the pending approvals."),(0,r.kt)("li",{parentName:"ul"},"After connecting the fee payer wallet, you can approve all the pending fee payer requests.")),(0,r.kt)("h2",{id:"2-gas-considerations"},"2. Gas Considerations"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To ensure the proper execution of CrossTalk requests on the destination chain, users must specify both the ",(0,r.kt)("inlineCode",{parentName:"li"},"gasPrice")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"gasLimit")," in their request metadata. This information is used to calculate the fees required for the transaction. ",(0,r.kt)("strong",{parentName:"li"},"If the ",(0,r.kt)("inlineCode",{parentName:"strong"},"gasPrice")," is not specified, the gas price oracle on the Router chain will estimate it.")),(0,r.kt)("li",{parentName:"ul"},"If an application intends to run its own relayer, it can set the ",(0,r.kt)("inlineCode",{parentName:"li"},"gasLimit")," parameter to ",(0,r.kt)("strong",{parentName:"li"},"0")," in their CrossTalk request. However, in such a scenario, the application's relayer must estimate the ",(0,r.kt)("inlineCode",{parentName:"li"},"gasLimit")," required for executing the transaction on the destination chain.")),(0,r.kt)("h2",{id:"3-deducting-fee"},"3. Deducting Fee"),(0,r.kt)("p",null,"CrossTalk operates on a prepaid fee model where the Router chain calculates the estimated fee for executing a transaction on the destination chain in terms of ROUTE tokens upon receiving the CrossTalk request. To cover the relayer incentives and validation costs, the Router chain deducts the estimated fee and incentive amount upfront from the fee payer address."),(0,r.kt)("h4",{id:"important-notes"},"Important Notes"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"The payment of fees and relayer incentives for any cross-chain request on the Router chain must be made exclusively in ROUTE tokens."),(0,r.kt)("li",{parentName:"ol"},"To thwart Sybil attacks on the Router chain, a minimal fee is charged by the Router's Gateway contract on the source chain. This fee covers the cost of orchestrator validation and is paid in the native token of the source chain by the application contract.")),(0,r.kt)("h2",{id:"4-handling-refunds"},"4. Handling Refunds"),(0,r.kt)("p",null,"Upon receiving the ack from the Gateway contract on the destination chain, the Router chain performs two actions: (a) it pays the fee used along with the relayer incentive to the relayer from the already deducted fee, and (b) refunds the surplus fee back to the fee payer address. This mechanism ensures the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The relayer receives its incentive without any delay."),(0,r.kt)("li",{parentName:"ul"},"Applications can send extra gas limit for buffer, as they will receive automatic refunds in case of a surplus fee.")))}d.isMDXComponent=!0}}]);
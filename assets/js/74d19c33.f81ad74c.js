"use strict";(self.webpackChunkrouter_docs=self.webpackChunkrouter_docs||[]).push([[8224],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>f});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),h=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=h(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=h(n),f=a,p=d["".concat(c,".").concat(f)]||d[f]||u[f]||o;return n?r.createElement(p,i(i({ref:t},l),{},{components:n})):r.createElement(p,i({ref:t},l))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var h=2;h<o;h++)i[h]=n[h];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2665:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>h});var r=n(87462),a=(n(67294),n(3905));const o={},i="Understanding Voyager",s={unversionedId:"voyager/understanding-voyager/README",id:"voyager/understanding-voyager/README",title:"Understanding Voyager",description:"Architecture",source:"@site/docs/develop/voyager/understanding-voyager/README.md",sourceDirName:"voyager/understanding-voyager",slug:"/voyager/understanding-voyager/",permalink:"/develop/voyager/understanding-voyager/",draft:!1,editUrl:"https://github.com/router-protocol/docs/tree/main/docs/develop/voyager/understanding-voyager/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/develop/voyager/"},next:{title:"Understanding different functions of Voyager",permalink:"/develop/voyager/understanding-voyager/understanding-different-functions"}},c={},h=[{value:"Architecture",id:"architecture",level:2},{value:"Flow of cross-chain token transfers:",id:"flow-of-cross-chain-token-transfers",level:3},{value:"Edge Cases",id:"edge-cases",level:4},{value:"Flow of cross-chain token transfers along with arbitrary instructions:",id:"flow-of-cross-chain-token-transfers-along-with-arbitrary-instructions",level:3},{value:"Edge Cases",id:"edge-cases-1",level:4},{value:"Fee Mechanism for Token Transfers/Swaps",id:"fee-mechanism-for-token-transfersswaps",level:3},{value:"Fee Mechanism for Arbitrary Instructions along with Token Transfers/Swaps",id:"fee-mechanism-for-arbitrary-instructions-along-with-token-transfersswaps",level:3}],l={toc:h};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"understanding-voyager"},"Understanding Voyager"),(0,a.kt)("h2",{id:"architecture"},"Architecture"),(0,a.kt)("p",null,"The Voyager consists of smart contracts which are deployed on all the blockchains that it supports and a middleware contract sitting on the Router Chain which forms the abstraction layer for many complexities of the cross-chain communication."),(0,a.kt)("p",null,"The smart contracts include the Voyager Deposit Handler, the Voyager Execute Handler, the Voyager Utils contract etc. The Voyager Deposit Handler is responsible for handling the deposits from users on the source chain while the Voyager Execute Handler is responsible for execution of the transaction on the destination chain."),(0,a.kt)("h3",{id:"flow-of-cross-chain-token-transfers"},"Flow of cross-chain token transfers:"),(0,a.kt)("p",null,"When a user calls a function to transfer funds to another chain, the Voyager Deposit Handler contract will process the transaction, deduct the funds from user\u2019s wallet and create a cross-chain communication request to the Router Chain endpoint. After receiving data from the source chain, our bridge contract on the Router Chain will process the request, make some necessary checks and deduct the fees required for the transaction to be processed. Once this is complete, it will fire a transaction to the destination chain to complete the cross-chain transfer request."),(0,a.kt)("h4",{id:"edge-cases"},"Edge Cases"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"What if liquidity is not available for a token on the destination chain?")),(0,a.kt)("p",{parentName:"li"},"The user will get the Wrapped tokens for those tokens on the destination chain which can be redeemed as soon as the liquidity is available on the chain.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"What if I end up getting lesser amount of tokens on the destination chain than the minimum amount promised to me?")),(0,a.kt)("p",{parentName:"li"},"This would never happen. The amount of destination tokens received depends on the DEX output while swapping the tokens. Maybe the output changed between the time that elapsed between when the amount was shown to you and the actual execution. In this case, the swap may result in lesser output for the user, but at Voyager, we have a policy of no loss to the user. So we provide you stable tokens equivalent to the minimum amount displayed to you instead of the token which was the output of the DEX so that you do not suffer any loss."))),(0,a.kt)("h3",{id:"flow-of-cross-chain-token-transfers-along-with-arbitrary-instructions"},"Flow of cross-chain token transfers along with arbitrary instructions:"),(0,a.kt)("p",null,"The flow is almost the same as that of token transfers. The main difference here is that the user also passes an arbitrary instructions from the source chain which is executed just after the token transfer is executed on the destination chain. The Voyager Execute Handler is responsible for calling the target contract on the destination chain. The target contract on the destination chain must implement the ",(0,a.kt)("code",null,"voyagerReceive"),"  function which is the entry point for the execution of the arbitrary instruction. An example to create send arbitrary instruction from a source chain and handling it on the destination chain is mentioned ",(0,a.kt)("a",{parentName:"p",href:"../building-different-use-cases/sequenced-transfers"},"here"),"."),(0,a.kt)("h4",{id:"edge-cases-1"},"Edge Cases"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"What if the token transfer is successful but the arbitrary instruction execution fails?")),(0,a.kt)("p",{parentName:"li"},"This would never happen as the transaction, by design, is atomic which means that either both will execute or none will execute. ")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"What if my transaction fails on the destination chain due to some issues? What happens to my funds?")),(0,a.kt)("p",{parentName:"li"},"No need to worry. We provide a replay function on our bridge contract on the Router Chain which can be called by any user to replay a failed request. You can fix the issues and call this replay function to replay your transaction on the destination chain. Your funds are safe!"))),(0,a.kt)("h3",{id:"fee-mechanism-for-token-transfersswaps"},"Fee Mechanism for Token Transfers/Swaps"),(0,a.kt)("p",null,"The fee is calculated on the bridge contract on the Router Chain based on the source chain, destination chain, the transaction volume and some other parameters. The fee consists of a flat fee and an additional bips based fee based on the transaction volume. "),(0,a.kt)("p",null,"The fee is deducted directly from the tokens transferred to the Voyager Deposit Handler on the source chain and the remaining amount of tokens are transferred to the recipient on the destination chain."),(0,a.kt)("p",null,"If the fee required for transaction is greater than the amount being transferred and the cost of reverting it is lesser than the amount transferred, the transaction will be reverted back on the source chain by a request from the bridge contract on the Router Chain."),(0,a.kt)("h3",{id:"fee-mechanism-for-arbitrary-instructions-along-with-token-transfersswaps"},"Fee Mechanism for Arbitrary Instructions along with Token Transfers/Swaps"),(0,a.kt)("p",null,"The fee mechanism for arbitrary instructions transfer along with the funds differs from that of normal fund transfers across chains because with arbitrary instructions, the user wants the same amount of tokens to be credited on the destination chain as were deducted on the source chain. "),(0,a.kt)("p",null,"The fees here entails the fees for token transfer plus the amount of gas limit passed for arbitrary instruction transfer to the destination chain. The fees will be deducted in the form of WRoute tokens on the Voyager middleware contract on the Router Chain from an account which will be known as fee payer. "),(0,a.kt)("p",null,"For this, the application has to register with Voyager by contacting the Voyager team to set an account as a fee payer admin for the application. This fee payer admin can then set any account on Router chain as the fee payer for requests originating from that application. Also the fee payer has to confirm on the Voyager middleware that it indeed wants to pay the fees for this application. This is a one time process and once done, fees for every request that originates from that application will be paid by the fee payer account. The fee payer admin can also change the fee payer address in the future by following the similar process."))}u.isMDXComponent=!0}}]);